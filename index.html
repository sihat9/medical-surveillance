<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medical Surveillance System</title>
    <link rel="stylesheet" href="style.css">
    <!-- QR Code Library -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <!-- SheetJS untuk Excel -->
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="screen active">
        <div class="login-container">
            <div class="login-header">
                <h1>üè• MEDICAL SURVEILLANCE SYSTEM</h1>
                <p>Sistem Pengurusan Borang USECHH Digital</p>
            </div>
            
            <div class="login-form">
                <div class="form-group">
                    <label for="userRole">Peranan:</label>
                    <select id="userRole" onchange="showRoleFields()">
                        <option value="">Pilih Peranan</option>
                        <option value="admin">Admin</option>
                        <option value="doctor">Doktor</option>
                        <option value="ma">Medical Assistant</option>
                    </select>
                </div>

                <div id="adminFields" class="role-fields">
                    <div class="form-group">
                        <label for="adminName">Nama Admin:</label>
                        <input type="text" id="adminName" placeholder="Nama admin">
                    </div>
                </div>

                <div id="doctorFields" class="role-fields">
                    <div class="form-group">
                        <label for="doctorId">ID Doktor:</label>
                        <input type="text" id="doctorId" placeholder="DR001">
                    </div>
                </div>

                <div id="maFields" class="role-fields">
                    <div class="form-group">
                        <label for="maId">ID MA:</label>
                        <input type="text" id="maId" placeholder="MA001">
                    </div>
                </div>
                
                <button onclick="login()" class="btn-primary">LOGIN</button>
            </div>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="adminDashboard" class="screen">
        <div class="dashboard-header">
            <button onclick="logout()" class="btn-back">‚Üê Logout</button>
            <h2>üë®‚Äçüíº ADMIN DASHBOARD</h2>
            <span id="adminWelcome"></span>
        </div>

        <div class="dashboard-content">
            <!-- Upload Section -->
            <div class="upload-section">
                <h3>üì§ Muat Naik Senarai Pekerja</h3>
                <div class="upload-box">
                    <input type="file" id="excelFile" accept=".xlsx,.xls,.csv" onchange="previewExcel()">
                    <label for="excelFile" class="upload-label">
                        üìé Pilih File Excel
                    </label>
                    <div id="filePreview"></div>
                    <button onclick="uploadWorkers()" class="btn-primary" id="uploadBtn" disabled>Muat Naik</button>
                </div>
            </div>

            <!-- Company List -->
            <div class="company-section">
                <h3>üè¢ Senarai Syarikat</h3>
                <div id="companyList" class="company-grid">
                    <!-- Dynamic company cards -->
                </div>
            </div>
        </div>
    </div>

    <!-- Doctor Dashboard -->
    <div id="doctorDashboard" class="screen">
        <div class="dashboard-header">
            <button onclick="logout()" class="btn-back">‚Üê Logout</button>
            <h2>üë®‚Äç‚öïÔ∏è DOKTOR DASHBOARD</h2>
            <span id="doctorWelcome"></span>
        </div>

        <div class="dashboard-content">
            <div class="filter-section">
                <input type="text" id="companySearch" placeholder="Cari syarikat..." onkeyup="filterCompanies()">
                <select id="statusFilter" onchange="filterCompanies()">
                    <option value="">Semua Status</option>
                    <option value="PENDING">Pending</option>
                    <option value="IN_PROGRESS">In Progress</option>
                    <option value="COMPLETED">Completed</option>
                </select>
            </div>

            <div id="doctorCompanyList" class="company-grid">
                <!-- Dynamic company cards for doctor -->
            </div>
        </div>
    </div>

    <!-- Worker List Screen -->
    <div id="workerListScreen" class="screen">
        <div class="dashboard-header">
            <button onclick="showScreen('doctorDashboard')" class="btn-back">‚Üê Kembali</button>
            <h2 id="workerListTitle">üë• Senarai Pekerja</h2>
        </div>

        <div class="worker-container">
            <div class="worker-table-container">
                <table class="worker-table">
                    <thead>
                        <tr>
                            <th>Nama</th>
                            <th>No IC/Passport</th>
                            <th>Jantina</th>
                            <th>Status</th>
                            <th>Tindakan</th>
                        </tr>
                    </thead>
                    <tbody id="workerTableBody">
                        <!-- Dynamic worker rows -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- QR Signature Screen -->
    <div id="qrSignatureScreen" class="screen">
        <div class="dashboard-header">
            <button onclick="showScreen('workerListScreen')" class="btn-back">‚Üê Kembali</button>
            <h2>‚úçÔ∏è Tandatangan Digital</h2>
        </div>

        <div class="qr-container">
            <div class="qr-info">
                <h3 id="qrWorkerName"></h3>
                <p id="qrWorkerIC"></p>
            </div>
            
            <div class="qr-code-container">
                <div id="qrcode"></div>
                <p>üì± Scan QR code dengan device lain untuk tandatangan</p>
            </div>

            <div class="signature-preview">
                <h4>Tandatangan Disimpan:</h4>
                <img id="signaturePreview" src="" style="display: none; max-width: 300px; border: 1px solid #ddd;">
                <p id="noSignatureText" style="color: #999;">Belum ada tandatangan</p>
            </div>
        </div>
    </div>

    <!-- Include other script files -->
    <script src="js/auth.js"></script>
    <script src="js/admin.js"></script>
    <script src="js/doctor.js"></script>
    <script src="js/qr-signature.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
